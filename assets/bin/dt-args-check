#!/usr/bin/env python3

# The inputs to this script is a list of strings of even number so that the name of an argument is passed
# right before its value. For example,
#
#
#       dt-args-check [options] -- [arg1_name] [arg1_value] [arg2_name] [arg2_value] ...
#
#

import sys

KNOWN_MODIFIERS = ["?"]


def main():
    args = sys.argv[1:]
    # make sure the number of arguments is even
    if len(args) % 2 != 0:
        print("ERROR: Number of arguments must be even and in the form:\n\n"
              "\t[arg1_name] [arg1_value] [arg2_name] [arg2_value] ...\n\n")
        exit(1)
    # check args
    for i in range(0, len(args) - 1, 2):
        name, value = args[i], args[i+1]
        optional: bool = name.endswith("?")
        name = name.rstrip("".join(KNOWN_MODIFIERS))
        if len(value.strip()) == 0 and not optional:
            print(f"ERROR: Argument '{name}' cannot be empty")
            exit(2)
    # ---
    print("PASSED: Your build arguments looks fine!")


if __name__ == '__main__':
    main()
